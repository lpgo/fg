<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>01</title>
    <link rel="stylesheet" href="ionic/css/ionic.min.css">
    <script src="ionic/js/angular/angular.min.js"></script>
    <style>
        #content{
            width: 50%;
            margin: 0 auto;
        }
        input {
            border: 1px solid grey;
            display: block;
            background-color: GrayText;
            color: white;

        }

        button {
            margin-top: 10px;
        }

        table {
            margin-top: 20px;
            border: 1px solid red;
            border-collapse: collapse;

        }

        th {
            border: 1px solid red;
            padding: 10px;
        }

        td {
            border: 1px solid red;

            padding: 10px;
        }

    </style>
</head>
<body ng-app="myApp" ng-controller="myCtrl">

<div id="content">
    name:<input type="text" ng-model="open_id">
    <button ng-click="adduser()">submit</button>
    <button ng-click="getuser()">getuser</button>

   
        <table>
            <tr>
                <th>current_seat</th>
                <th>line</th>
                <th>owner_id</th>
                <th>seat_count</th>
            </tr>

            <tr ng-repeat="x in names">
                <td>{{x.current_seat}}</td>
                <td>{{x.line}}</td>
                <td>{{x.owner_id}}</td>
                <td>{{x.seat_count}}</td>

            </tr>
        </table>
</div>
</body>
<script>
    var app = angular.module('myApp', []);
   app.config(function($httpProvider) {
    $httpProvider.defaults.headers.put['Content-Type'] = 'application/x-www-form-urlencoded';
    $httpProvider.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';
 
    // Override $http service's default transformRequest
    $httpProvider.defaults.transformRequest = [function(data) {
        /**
         * The workhorse; converts an object to x-www-form-urlencoded serialization.
         * @param {Object} obj
         * @return {String}
         */
        var param = function(obj) {
            var query = '';
            var name, value, fullSubName, subName, subValue, innerObj, i;
 
            for (name in obj) {
                value = obj[name];
 
                if (value instanceof Array) {
                    for (i = 0; i < value.length; ++i) {
                        subValue = value[i];
                        fullSubName = name + '[' + i + ']';
                        innerObj = {};
                        innerObj[fullSubName] = subValue;
                        query += param(innerObj) + '&';
                    }
                } else if (value instanceof Object) {
                    for (subName in value) {
                        subValue = value[subName];
                        fullSubName = name + '[' + subName + ']';
                        innerObj = {};
                        innerObj[fullSubName] = subValue;
                        query += param(innerObj) + '&';
                    }
                } else if (value !== undefined && value !== null) {
                    query += encodeURIComponent(name) + '='
                            + encodeURIComponent(value) + '&';
                }
            }
 
            return query.length ? query.substr(0, query.length - 1) : query;
        };
 
        return angular.isObject(data) && String(data) !== '[object File]'
                ? param(data)
                : data;
    }];
});
    app.controller("myCtrl", function ($scope, $http) {

        $scope.names=[{current_seat:2,line:3,owner_id:4,seat_count:5}];
        $scope.adduser= function () {
            $http.post("http://localhost:6767/login", {open_id: $scope.open_id})
                    .success(function (response) {

                            console.log(response);

                    });

        }
        $scope.getuser=function(){
            $http.post("http://localhost:6767/get_trips")
                    .success(function (response) {
                        for(i=0;i<response.length;i++){

                            $scope.names.push(response[i])
                        }
                        


                    });
        }


    });

</script>

</html>